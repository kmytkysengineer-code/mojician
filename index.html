<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3218654889585206"
     crossorigin="anonymous"></script>
  <meta name="google-site-verification" content="Ap9OCYqmddWcOk52UNwb4F_uW9ItZE5Am_e5rOhie2k" />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NK8NJSP8SY"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-NK8NJSP8SY');
  </script>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Mojician（モジシャン）｜文字列加工・改行変換・重複削除・結合・整形が無料でできる文字操作ツール</title>
  <meta name="description" content="Mojician（モジシャン）は、Excel関数を覚えなくても文字をまとめて整えられる無料Webツールです。パソコンが苦手な方でも、貼り付けてボタンを押すだけでかんたんに文字加工できます。" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://mojician.jp/" />

  <!-- OGP -->
  <meta property="og:title" content="Mojician（モジシャン）｜文字列加工・文字列整形をやさしくお手伝い" />
  <meta property="og:description" content="Excel関数いらず。貼り付けてボタンを押すだけのやさしい文字加工ツール。" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://mojician.jp/" />
  <meta name="twitter:card" content="summary_large_image" />

  <style>
    :root{
      --bg: #f4f8ff;
      --bg-grad-1:#eaf2ff;
      --bg-grad-2:#f6fffb;
      --card:#ffffff;
      --card-soft:#f8fbff;
      --text:#1b2540;
      --muted:#5b6a8a;
      --accent:#6f92ff;
      --accent2:#7ddac6;
      --accent3:#ffd37a;
      --border:#e6ecfa;
      --radius:22px;
      --radius-sm:14px;
      --shadow: 0 8px 24px rgba(24, 48, 114, 0.08);
      --shadow-soft: 0 6px 18px rgba(24, 48, 114, 0.06);
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 700px at -10% -20%, var(--bg-grad-1), transparent 70%),
        radial-gradient(1000px 800px at 110% -10%, var(--bg-grad-2), transparent 65%),
        var(--bg);
      line-height:1.8;
    }
    a{color:#3b63ff; text-decoration:none;}
    a:hover{text-decoration:underline;}
    .wrap{max-width:1280px; margin:0 auto; padding:0 16px;}

    header{
      position:sticky; top:0; z-index:10;
      background:rgba(244,248,255,0.85);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--border);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 0;
    }
    .logo {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      font-weight: 900;
      text-decoration: none;
      color: inherit;
    }

    .logo:hover {
      text-decoration: none;
    }
    .logo-badge{
      width:34px; height:34px; border-radius:12px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      display:grid; place-items:center; color:white; font-weight:900;
      box-shadow: var(--shadow-soft);
    }
    .nav-links{display:flex; gap:12px; font-size:0.95rem; color:var(--muted);}
    .nav-links a{color:var(--muted); padding:6px 8px; border-radius:10px;}
    .nav-links a:hover{background:#eef3ff; color:var(--text); text-decoration:none;}

    /* HERO */
    .hero{
      padding:44px 0 20px;
      display:grid; grid-template-columns:1.1fr 0.9fr; gap:16px; align-items:center;
    }
    @media (max-width:900px){ .hero{grid-template-columns:1fr; padding-top:28px;} }
    .hero h1 span {
      color: var(--accent);
      text-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
      position: relative;
    }
    .hero-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:28px; padding:22px;
      box-shadow: var(--shadow);
    }
    h1{font-size:2rem; margin:0 0 8px;}
    .subtitle{color:var(--muted); font-size:1.05rem;}
    .cta-row{display:flex; gap:10px; flex-wrap:wrap; margin-top:16px;}
    .btn{
      padding:12px 16px;
      border-radius:14px;
      font-weight:800;
      font-size:1rem;
      border:1px solid #d6def2;
      background:#eef3ff;
      color:var(--text);
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow: var(--shadow-soft);
    }
    .btn:hover{
      transform:translateY(-1px);
      background:#e3ebff;
    }
    .btn-primary{
      background:linear-gradient(135deg,var(--accent),#5a78ff);
      color:white; border:none;
    }
    .btn-pro-login {
      background: #1b2540;
      color: #ffffff;
      border: none;
    }
    
    .btn-pro-login:hover {
      background: #11182c;
    }
    .btn-ghost{
      background:transparent; box-shadow:none;
    }
    .mini{
      font-size:0.9rem; color:var(--muted); margin-top:10px;
    }

    section{padding:20px 0;}
    .grid3{display:grid; grid-template-columns:repeat(3,1fr); gap:12px;}
    @media (max-width:900px){.grid3{grid-template-columns:1fr;}}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: var(--shadow-soft);
    
      /* 追加 */
      transition:
        transform 0.25s ease,
        box-shadow 0.25s ease,
        border-color 0.25s ease;
    }
    .card:hover{
      transform: translateY(-4px);
      box-shadow:
        0 14px 24px -6px rgba(59,130,246,0.25),
        0 0 0 1px rgba(59,130,246,0.12);
      border-color: var(--accent);
    }
    .card h3{margin:0 0 6px; font-size:1.1rem;}
    .tag{
      display:inline-flex; align-items:center; gap:6px;
      font-size:0.8rem; color:#3a4a6b; padding:5px 10px;
      background:#f2f6ff; border-radius:999px; font-weight:800;
      border:1px solid var(--border);
    }
    .example{
      background:var(--card-soft);
      border:1px dashed #d9e2fb;
      border-radius:16px; padding:12px;
      font-family: ui-monospace, Consolas, monospace;
      font-size:0.95rem; white-space:pre-wrap;
      color:#273656;
    }
    .two-col{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    @media (max-width:900px){.two-col{grid-template-columns:1fr;}}

    /* ===== カード差別化用 ===== */

    /* Mojicianとは？ 用の導入カード */
    .card.card-intro {
      position: relative;
      padding-top: 52px; /* 帯の分だけ余白を増やす */
    }
    
    /* 上部アクセント帯 */
    .card.card-intro::before {
      content: "Mojicianとは？";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 36px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: #ffffff;
      font-weight: 800;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      padding-left: 16px;
      border-radius: 22px 22px 0 0;
    }

    
    /* Proカード */
    .card-pro {
      background: #f9fbff;
    }

    .card-pro h3 {
      font-weight: 900;
    }

    /* 強調カード（1枚だけ使う） */
    .card-highlight {
      border: 2px solid var(--accent);
    }

    /* Proカード用タグ */
    .tag-pro {
      background: linear-gradient(135deg, #6f92ff, #7ddac6);
      color: #fff;
      border: none;
    }

    .tool-more {
      margin-top: 8px;
      text-align: right;
    }
    
    .tool-more a {
      font-size: 0.85rem;
      color: #5b6a8a;
      text-decoration: none;
    }
    
    .tool-more a:hover {
      text-decoration: underline;
    }
    
    .subtitle li{margin-bottom:6px;}

    .faq details{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px; padding:14px; margin-bottom:8px;
      box-shadow: var(--shadow-soft);
    }
    .faq summary{cursor:pointer; font-weight:800;}

    footer{
      margin-top:24px; padding:18px 0 30px;
      border-top:1px solid var(--border); color:var(--muted);
      font-size:0.9rem;
    }
    .footer-links{display:flex; gap:12px; flex-wrap:wrap;}
    .footer-links a{color:var(--muted);}
  </style>
</head>

<body>
<header>
  <div class="wrap nav">
    <a href="/" class="logo">
      <div class="logo-badge">M</div>
      <div>Mojician🪄</div>
    </a>
  
    <nav class="nav-links">
      <a href="#tools">ツール一覧</a>
      <a href="#faq">FAQ</a>
      <a href="/pro.html">有料版（Pro）</a>
      <a href="https://pro.mojician.jp/auth/signin">ログイン</a>
    </nav>
  </div>
</header>

<main class="wrap">

  <!-- HERO -->
  <section class="hero">
    <div>
      <h1>そのひと手間に、<br><span>魔法をひと振り</span></h1>
      <p class="subtitle">
        Mojician（モジシャン）は、パソコンが少し苦手な方でも使いやすい<br>
        <b>文字加工ツール</b>です。<br>
        文字をまとめて整えたいときに、貼り付けてボタンを押すだけでOK。
      </p>

      <div class="cta-row">
        <a class="btn btn-primary" href="#tools">🌟 今すぐ無料で使う</a>
        <a class="btn btn-ghost" href="#pro">Pro版を検討する</a>
      </div>

      <p class="mini">
        ✅ 登録不要 / ✅ ブラウザだけで完結 / ✅ 入力データは保存しません
      </p>
    </div>

    <div class="hero-card">
      <h2 style="margin:8px 0 6px;font-size:1.2rem;">前後に文字をまとめて追加</h2>
      <p class="subtitle" style="font-size:1rem;">
        各行の前後に同じ文字をつけたい時に便利です。<br>
        記号で囲む作業なども、すぐ終わります。
      </p>
      <div class="example">入力：
apple
banana
cherry

前：「'」　後：「'」

出力：
'apple'
'banana'
'cherry'</div>
    </div>
  </section>

  <section class="card card-intro" style="margin-bottom:20px;">
    <p class="subtitle">
      Mojician（モジシャン）は、文字列の加工・整形を
      ブラウザだけで簡単に行える無料Webツールです。
    </p>
    <p class="subtitle">
      Excel関数やプログラミングの知識がなくても、
      コピー＆ペーストとボタン操作だけで
      文字の前後追加・重複削除・並び替えなどを行えます。
    </p>
  
    <p class="subtitle">
      Mojicianは、日々の作業で発生する「同じ文字加工を何度も行う手間」を減らすために、
      実務でよく使われる処理だけを厳選してまとめたツールです。
    </p>
  
    <p class="subtitle">
      事務作業やデータ整理、SQL作成前の下処理など、
      日常業務の「ちょっと面倒」を減らすことを目的に作りました。
    </p>
  </section>
  <br>
  
  <!-- FEATURES -->
<section class="workspace" style="border: 2px solid #e2e8f0; background: #fff;">
  <div style="padding: 10px 20px;">
    <h2 style="font-size: 1.8rem; margin-top: 0; color: var(--text-main);">専門知識や複雑な関数は不要です</h2>
    <p style="color: var(--text-main); line-height: 1.8; margin-top: 16px;">
      テキストの整形や加工を行う際、Excelの複雑な関数（SUBSTITUTEやCONCATENATEなど）を組み合わせたり、専用のプログラムを組んだりする必要はありません。
      <br>
      Mojicianは、非エンジニアの方や事務職の方でも、直感的な操作だけで文字列操作を完結できるよう設計されています。
      <br><br>
      「やりたい加工」に合わせた専用の入力欄にテキストを貼り付け、実行ボタンをクリックするだけ。操作方法を調べる時間を最小限に抑え、本来の業務に集中できる環境を提供します。
    </p>
  </div>
</section>
<br>
<section class="workspace" style="border: 2px solid #e2e8f0; background: #fff;">
  <div style="padding: 10px 20px;">
    <h2 style="font-size: 1.8rem; margin-top: 0; color: var(--text-main);">定型的な事務作業を自動化し、ヒューマンエラーを防止</h2>
    <p style="color: var(--text-main); line-height: 1.8; margin-top: 16px;">
      名簿の整理、システム登録用データの作成、大量のID一覧への記号追加など、手作業で行う文字加工には常に「コピーミス」や「変換漏れ」のリスクが伴います。
      <br><br>
      Mojicianを利用することで、数百行、数千行に及ぶデータであっても一括で、かつ正確に処理することが可能です。
      <br>
      単純なコピペ作業に費やしていた時間を大幅に短縮し、作業精度の向上と業務効率の最大化を同時に実現します。
    </p>
  </div>
</section>
<br>
<section id="security-policy" class="workspace" style="border: 2px solid #e2e8f0; background: #fff;">
  <div style="padding: 10px 20px;">
    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
      <span style="background: #10b981; color: white; padding: 4px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: bold;">セキュリティ</span>
      <h2 style="font-size: 1.8rem; margin: 0; color: var(--text-main);">機密情報の取り扱いについて</h2>
    </div>
    <p style="color: var(--text-main); line-height: 1.8;">
      ビジネスシーンでの利用を想定し、Mojicianではユーザーのプライバシーとデータセキュリティを最優先事項としています。本サービスが安全に利用できる技術的根拠は以下の通りです。
    </p>
    <ul style="color: var(--text-main); line-height: 2; margin-top: 16px;">
      <li><strong>クライアントサイド処理の徹底：</strong> 入力されたテキストデータは、すべてお客様のブラウザ内（JavaScript）で処理されます。データが当サイトのサーバーへ送信される仕組みはありません。</li>
      <li><strong>データの保存・学習の排除：</strong> サーバーを介さないため、入力内容がログとして残ることや、AIの学習用データとして再利用されることはありません。</li>
      <li><strong>外部漏洩リスクの遮断：</strong> 通信が発生しないため、機密性の高い社内データや個人情報、IDリストなども安心して加工いただけます。</li>
    </ul>
  </div>
</section>

<section class="workspace" style="background: #f8fafc; border-top: 1px solid var(--border);">
  <div style="padding: 10px 20px;">    
    <div style="background: white; padding: 24px; border-radius: var(--radius-md); border: 1px solid var(--border);">
      <h3 style="font-size: 1.1rem; color: var(--text-main); margin-top: 0; display: flex; align-items: flex-start; gap: 10px;">
        <span style="color: var(--accent); font-weight: 900;">Q.</span>
        なぜテキスト加工にAIを使わないのか？
      </h3>
      
      <div style="margin-left: 28px; color: var(--text-muted); line-height: 1.8;">
        <p style="margin-bottom: 16px;">
          <span style="color: #e11d48; font-weight: bold;">A.</span>
          お客様のデータを「外部へ送信しないこと」と「加工の確実性を担保すること」を最優先しているためです。
        </p>
        <p>
          現在、多くのAIサービスは入力されたデータをクラウドサーバーで処理する仕組みを採用しており、
          サービスによっては入力内容が学習や品質向上の目的で利用される場合があります。
          機密性の高いビジネスデータを扱う際、これは情報の漏洩リスクとなり得ます。
        </p>
        <p>
          また、AIツールのように「どう指示を書けばよいか（プロンプト）」を考える必要もありません。
          Mojicianでは、やりたい加工内容に合わせて項目を選ぶだけで、
          誰でも同じ結果を安定して得られるよう設計しています。
        </p>
        <p>
          Mojicianは、あえてAIを使わず、ブラウザ上で動作する事前に定義された処理ルール（プログラム）のみで加工を行います。これにより、以下の3点をお約束しています。
        </p>
        <ul style="margin-top: 12px; padding-left: 20px;">
          <li><strong>外部送信なし：</strong> 外部サーバーやAI学習モデルへデータが送られる仕組みはありません。</li>
          <li><strong>加工の正確性：</strong> AI特有の「推測による意図しない書き換え」が発生せず、常に一貫した結果を返します。</li>
          <li><strong>超高速処理：</strong> クラウドとの通信待機時間が発生しないため、貼り付けた瞬間に加工が完了します。</li>
        </ul>
      </div>
    </div>
  </div>
</section>

  <!-- TOOLS -->
  <section id="tools">
    <h2 style="font-size:1.5rem;margin-bottom:6px;">無料ツール</h2>
    <p class="subtitle">よく使う文字加工を、内容ごとに提供します。各ツールに移動した後にブックマークをしておけば、次回から移動なく開くことができます。</p>

    <div class="grid3">
      <div class="card">
        <h3>① 前後追加（Prefix/Suffix）</h3>
        <p class="subtitle">文字の最初や最後に、同じ文字をまとめて付けられます。</p>
        <p class="subtitle">
          このツールは、各行の文字列に同じ記号や文字を一括で付けたい場合に便利です。
          SQLのIN句作成、CSVデータの整形、引用符で囲む作業などを、
          手作業せずにまとめて行えます。
        </p>
        <div class="tool-more">
          <a href="/tool/prefix-suffix.html"
             onclick="gtag('event','tool_more',{tool:'prefix_suffix'});">
            もっと詳しく →
          </a>
        </div>
        <p class="mini" style="margin-top:4px;">例）apple → 'apple'</p>
        <a href="#tool-prefix-suffix" class="btn btn-ghost" style="margin-top:6px;">使う🪄</a>
      </div>

      <div class="card">
        <h3>② 改行 ↔ カンマ変換</h3>
        <p class="subtitle">改行をカンマ区切りにしたり、逆に戻したりできます。</p>
        <p class="subtitle">
          改行で並んだリストをカンマ区切りにしたり、
          逆にカンマ区切りの文字列を改行リストに戻したりできます。
          Excelやシステムへの貼り付け前の整形作業に役立ちます。
        </p>
        <div class="tool-more">
          <a href="/tool/newline-comma.html"
             onclick="gtag('event','tool_more',{tool:'newline-comma'});">
            もっと詳しく →
          </a>
        </div>
        <p class="mini" style="margin-top:4px;">例）改行「A↵B↵C」→「A, B, C」</p>
        <a href="#tool-newline-comma" class="btn btn-ghost" style="margin-top:6px;">使う🪄</a>
      </div>

      <div class="card">
        <h3>③ 重複削除</h3>
        <p class="subtitle">同じ項目が並んだリストを、重複だけ消してきれいにします。</p>
        <p class="subtitle">
          このツールは、一覧データの中に含まれる重複項目をまとめて削除します。
          順番はそのまま維持されるため、
          名簿・リスト・データ整理の前処理として安心して使えます。
        </p>
        <div class="tool-more">
          <a href="/tool/deduplicate.html"
             onclick="gtag('event','tool_more',{tool:'deduplicate'});">
            もっと詳しく →
          </a>
        </div>
        <p class="mini" style="margin-top:4px;">例）apple, banana, apple → apple, banana</p>
        <a href="#tool-deduplicate" class="btn btn-ghost" style="margin-top:6px;">使う🪄</a>
      </div>
  
      <div class="card">
        <h3>④ 文字の結合</h3>
        <p class="subtitle">左右のリストを行ごとに結合します。</p>
        <p class="subtitle">
          左右に分かれた2つのリストを、行ごとに結合できます。
          拠点名＋部署名、ID＋名称など、
          2列データを1つの文字列にまとめたい場合に便利です。
        </p>
        <div class="tool-more">
          <a href="/tool/two-col-join.html"
             onclick="gtag('event','tool_more',{tool:'two-col-join'});">
            もっと詳しく →
          </a>
        </div>
        <p class="mini" style="margin-top:4px;">例）左：A / B　右：X → A_X / B_X</p>
        <a href="#tool-two-col-join" class="btn btn-ghost" style="margin-top:6px;">使う🪄</a>
      </div>

      <div class="card">
        <h3>⑤ 行の削除・抽出（含む文字）</h3>
        <p class="subtitle">含まれている文字をもとに、行を「削除」または「抽出」できます。</p>
        <p class="subtitle">
          指定した文字を含む行だけを削除したり、逆に抽出したりできます。
          NGデータの除外や、条件に合う行だけを取り出すなど、
          データチェックや整理作業に役立ちます。
        </p>
        <div class="tool-more">
          <a href="/tool/remove-contains.html"
             onclick="gtag('event','tool_more',{tool:'remove-contains'});">
            もっと詳しく →
          </a>
        </div>
        <p class="mini" style="margin-top:4px;">例）「NG」を含む行だけ抽出 / 削除</p>
        <a href="#tool-remove-contains" class="btn btn-ghost" style="margin-top:6px;">使う🪄</a>
      </div>

      <div class="card">
        <h3>⑥ 行の並び替え（ソート）</h3>
        <p class="subtitle">
          改行リストを、昇順・降順で並び替えます。  
          文字列/数値ソートも選べます。
        </p>
        <p class="subtitle">
          改行で並んだデータを昇順・降順に並び替えます。
          数値としての並び替えにも対応しているため、
          IDや番号リストの整理にも使えます。
        </p>
        <div class="tool-more">
          <a href="/tool/sort-lines.html"
             onclick="gtag('event','tool_more',{tool:'sort-lines'});">
            もっと詳しく →
          </a>
        </div>
        <p class="mini" style="margin-top:4px;">例）3 ↵ 10 ↵ 2 ↵ 1 → 1 / 2 / 3 / 10</p>
        <a href="#tool-sort-lines" class="btn btn-ghost" style="margin-top:6px;">使う🪄</a>
      </div>
    </div>

    <br>
    <div style="margin: 20px 0; text-align:center;">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-3218654889585206"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
    <br>
    
    <h2 style="font-size:1.5rem;margin-bottom:6px;">Pro版ツール（さらに便利に使いたい方へ）</h2>
    <p class="subtitle">
      無料ツールで慣れてきた方向けに、  
      <b>作業時間を大きく短縮できる機能</b>を用意しています。
    </p>
    <p class="subtitle">
      条件保存や差分比較など、  
      実務で「あと一歩ほしい」機能をまとめました。
    </p>
    
    <div class="grid3">
      <div class="card card-pro">
        <span class="tag tag-pro">Pro</span>
        <h3>テキスト差分比較</h3>
        <p class="subtitle">
          2つのテキストを左右に並べて比較し、
          違いがある行だけを分かりやすく表示します。
        </p>
        <p class="mini">
          例）修正前 / 修正後のチェック
        </p>
      </div>

      
      <div class="card card-pro">
        <span class="tag tag-pro">Pro</span>
        <h3>特定位置に文字を挿入</h3>
        <p class="subtitle">
          各行の決まった位置に、同じ文字をまとめて挿入できます。
        </p>
        <p class="mini">
          例）ABC123 → ABC-123
        </p>
      </div>

      
      <div class="card card-pro">
        <span class="tag tag-pro">Pro</span>
        <h3>複数キーワードの一括置換</h3>
        <p class="subtitle">
          対応表（辞書）を使って、文字をまとめて置き換えます。
        </p>
        <p class="mini">
          例）東京 → TOKYO / 大阪 → OSAKA
        </p>
      </div>

    </div>
  
  </section>

  <!-- === FREE TOOL ① : 前後追加ツール === -->
  <section id="tool-prefix-suffix" style="margin-top:32px;">
    <h2 style="font-size:1.4rem; margin-bottom:10px;">前後に文字をまとめて追加</h2>
    <p class="subtitle" style="margin-bottom:14px;">
      文字の前後に同じ文字をまとめて付けられます。  
      記号で囲む、括弧でくくる、などの作業に便利です。
    </p>

    <div style="
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 22px;
      padding: 18px;
      box-shadow: var(--shadow-soft);
    ">
      <div style="display:flex; flex-direction:column; gap:14px;">

        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">入力（複数行OK）：</label>
          <textarea id="inputText" rows="6" style="
            width:100%; padding:12px; border-radius:14px;
            border:1px solid var(--border); font-size:1rem;
            font-family:system-ui;
          " placeholder="ここに加工したい文字を貼り付けてください"></textarea>
        </div>

        <div style="display:flex; gap:12px; flex-wrap:wrap;">
          <div style="flex:1;">
            <label style="font-weight:700; display:block; margin-bottom:6px;">前につける文字：</label>
            <input id="prefix" type="text" style="
              width:100%; padding:10px;
              border-radius:14px; border:1px solid var(--border);
              font-size:1rem;
            " placeholder="' や「【」など">
          </div>

          <div style="flex:1;">
            <label style="font-weight:700; display:block; margin-bottom:6px;">後につける文字：</label>
            <input id="suffix" type="text" style="
              width:100%; padding:10px;
              border-radius:14px; border:1px solid var(--border);
              font-size:1rem;
            " placeholder="' や「】」など">
          </div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button onclick="runPrefixSuffix(); gtag('event', 'tool_run', { tool: 'prefix_suffix' });" class="btn btn-primary" style="min-width:200px;">
            変換する🪄
          </button>

          <button onclick="clearTool1()" class="btn">
            クリア
          </button>
        </div>

        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">出力：</label>
          <textarea id="outputText" rows="6" style="
            width:100%; padding:12px; border-radius:14px;
            border:1px solid var(--border); font-size:1rem;
            font-family:ui-monospace;
          " readonly></textarea>

        <button id="copy1"
          onclick="copyText('outputText','copy1')"
          class="btn copy-btn" style="margin-top:10px;">
          コピーする
        </button>

        </div>

      </div>
    </div>
  </section>

  <script>
    function runPrefixSuffix() {
      const text = document.getElementById("inputText").value;
      const prefix = document.getElementById("prefix").value;
      const suffix = document.getElementById("suffix").value;

      if (!text.trim()) {
        alert("入力欄が空です");
        return;
      }

      const lines = text.split(/\r?\n/);
      // ★ 末尾が空行（空文字 or 空白だけ）の場合は処理対象から外す
      while (lines.length > 0 && lines[lines.length - 1].trim() === "") {
        lines.pop();
      }
      
      const result = lines.map(line => prefix + line + suffix).join("\n");
      document.getElementById("outputText").value = result;
    }

    function clearTool1(){
      document.getElementById("inputText").value = "";
      document.getElementById("prefix").value = "";
      document.getElementById("suffix").value = "";
      document.getElementById("outputText").value = "";
    }
  </script>

  <!-- === FREE TOOL ② : 改行 ↔ カンマ変換ツール === -->
  <section id="tool-newline-comma" style="margin-top:32px;">
    <h2 style="font-size:1.4rem; margin-bottom:10px;">改行 ↔ カンマ区切りを変換</h2>
    <p class="subtitle" style="margin-bottom:14px;">
      改行で並んだ文字を「カンマ区切り」にしたり、  
      カンマ区切りの文字を「改行一覧」に戻したりできます。
    </p>

    <div style="
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 22px;
      padding: 18px;
      box-shadow: var(--shadow-soft);
    ">
      <div style="display:flex; flex-direction:column; gap:14px;">

        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">入力：</label>
          <textarea id="inputText2" rows="6" style="
            width:100%; padding:12px; border-radius:14px;
            border:1px solid var(--border); font-size:1rem;
            font-family:system-ui;
          " placeholder="ここに文字を貼り付けてください（改行 or カンマ区切りどちらでもOK）"></textarea>
        </div>

        <div class="card" style="background:var(--card-soft);">
          <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
            <label style="font-weight:700;">変換オプション：</label>

            <label style="display:flex; align-items:center; gap:6px;">
              <input type="checkbox" id="trimSpaces2" checked>
              前後の空白を消す
            </label>

            <label style="display:flex; align-items:center; gap:6px;">
              <input type="checkbox" id="removeEmpty2" checked>
              空行・空要素を無視
            </label>
          </div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button onclick="toComma(); gtag('event', 'tool_run', { tool: 'toComma' });" class="btn btn-primary" style="min-width:220px;">
            改行 → カンマ区切り🪄
          </button>

          <button onclick="toNewline(); gtag('event', 'tool_run', { tool: 'toNewline' });" class="btn" style="min-width:220px;">
            カンマ区切り → 改行🪄
          </button>

          <button onclick="clearTool2()" class="btn btn-ghost">
            クリア
          </button>
        </div>

        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">出力：</label>
          <textarea id="outputText2" rows="6" style="
            width:100%; padding:12px; border-radius:14px;
            border:1px solid var(--border); font-size:1rem;
            font-family:ui-monospace;
          " readonly></textarea>

        <button id="copy2"
          onclick="copyText('outputText2','copy2')"
          class="btn copy-btn" style="margin-top:10px;">
          コピーする
        </button>

        </div>

      </div>
    </div>
  </section>

  <script>
    function normalizeItems2(raw, splitByComma){
      let items;
      if(splitByComma){
        items = raw.split(",");
      }else{
        items = raw.split(/\r?\n/);
      }

      const trimSpaces = document.getElementById("trimSpaces2").checked;
      const removeEmpty = document.getElementById("removeEmpty2").checked;

      items = items.map(x => trimSpaces ? x.trim() : x);

      // ★ 末尾が空行なら削除
      while (items.length > 0 && items[items.length - 1].trim() === "") {
        items.pop();
      }
      
      if(removeEmpty){
        items = items.filter(x => x !== "");
      }
      return items;
    }

    function toComma(){
      const raw = document.getElementById("inputText2").value;
      if(!raw.trim()){
        alert("入力欄が空です");
        return;
      }
      const items = normalizeItems2(raw, false);
      document.getElementById("outputText2").value = items.join(", ");
    }

    function toNewline(){
      const raw = document.getElementById("inputText2").value;
      if(!raw.trim()){
        alert("入力欄が空です");
        return;
      }
      const items = normalizeItems2(raw, true);
      document.getElementById("outputText2").value = items.join("\n");
    }

    function clearTool2(){
      document.getElementById("inputText2").value = "";
      document.getElementById("outputText2").value = "";
    }
  </script>

<!-- === FREE TOOL ③ : 重複削除ツール（区切り選択なし） === -->
<section id="tool-deduplicate" style="margin-top:32px;">
  <h2 style="font-size:1.4rem; margin-bottom:10px;">重複をまとめて削除</h2>
  <p class="subtitle" style="margin-bottom:14px;">
    同じ内容が何度も出てくるリストを、きれいに整理します。  
    順番はそのままで、重複だけ削除します。
  </p>

  <div style="
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 22px;
    padding: 18px;
    box-shadow: var(--shadow-soft);
  ">
    <div style="display:flex; flex-direction:column; gap:14px;">

      <!-- 入力欄 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">
          入力（改行でもカンマでもOK）：
        </label>
        <textarea id="inputText3" rows="6" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:system-ui;
        " placeholder="例）
apple
banana
apple
cherry, banana"></textarea>
      </div>

      <!-- オプション（シンプル版） -->
      <div class="card" style="background:var(--card-soft);">
        <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
          <label style="font-weight:700;">オプション：</label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="trimSpaces3" checked>
            前後の空白を消す
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="removeEmpty3" checked>
            空行・空要素を無視
          </label>
        </div>
      </div>

      <!-- ボタン -->
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button onclick="deduplicateList(); gtag('event', 'tool_run', { tool: 'deduplicateList' });" class="btn btn-primary" style="min-width:220px;">
          重複を削除する🪄
        </button>

        <button onclick="clearTool3()" class="btn btn-ghost">
          クリア
        </button>
      </div>

      <!-- 出力 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">出力：</label>
        <textarea id="outputText3" rows="6" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:ui-monospace;
        " readonly></textarea>

      <button id="copy3"
        onclick="copyText('outputText3','copy3')"
        class="btn copy-btn" style="margin-top:10px;">
        コピーする
      </button>

      </div>

      <!-- 例 -->
      <div class="example" style="font-size:0.9rem;">
        例：<br>
        入力： apple / banana / apple / cherry / banana<br>
        出力： apple / banana / cherry
      </div>

    </div>
  </div>
</section>

<script>
  // 区切りは自動判定：改行があれば改行優先 → なければカンマ → なければ空白
  function splitItemsAuto3(raw){
    if(raw.includes("\n")) return raw.split(/\r?\n/);
    if(raw.includes(",")) return raw.split(",");
    return raw.split(/\s+/);
  }

  function deduplicateList(){
    const raw = document.getElementById("inputText3").value;
    if(!raw.trim()){
      alert("入力欄が空です");
      return;
    }

    let items = splitItemsAuto3(raw);

    const trimSpaces = document.getElementById("trimSpaces3").checked;
    const removeEmpty = document.getElementById("removeEmpty3").checked;

    if(trimSpaces){
      items = items.map(x => x.trim());
    }

    // ★ 末尾が空行（空文字 or 空白だけ）の場合は処理対象から外す
    while (items.length > 0 && items[items.length - 1].trim() === "") {
      items.pop();
    }
    
    if(removeEmpty){
      items = items.filter(x => x !== "");
    }

    // 順番維持で重複削除
    const seen = new Set();
    const uniqueItems = items.filter(x => {
      if(seen.has(x)) return false;
      seen.add(x);
      return true;
    });

    // 出力は改行で返す（見やすさ優先）
    document.getElementById("outputText3").value = uniqueItems.join("\n");
  }


  function clearTool3(){
    document.getElementById("inputText3").value = "";
    document.getElementById("outputText3").value = "";
  }
</script>

<!-- === FREE TOOL ④ : 左右リスト結合ツール（最終仕様） === -->
<section id="tool-two-col-join" style="margin-top:32px;">
  <h2 style="font-size:1.4rem; margin-bottom:10px;">左右のリストを行ごとに結合</h2>
  <p class="subtitle" style="margin-bottom:14px;">
    左と右に別々のリストを貼り付けるだけで、同じ行どうしを結合できます。  
    片側が1行だけのときは、その文字を全行にまとめて付けられます。
  </p>

  <div style="
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 22px;
    padding: 18px;
    box-shadow: var(--shadow-soft);
  ">
    <div style="display:flex; flex-direction:column; gap:14px;">

      <!-- 左右入力 -->
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">左のリスト：</label>
          <textarea id="leftText4" rows="7" style="
            width:100%; padding:12px; border-radius:14px;
            border:1px solid var(--border); font-size:1rem;
            font-family:system-ui;
          " placeholder="例）
東京
大阪
名古屋"></textarea>
        </div>

        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">右のリスト：</label>
          <textarea id="rightText4" rows="7" style="
            width:100%; padding:12px; border-radius:14px;
            border:1px solid var(--border); font-size:1rem;
            font-family:system-ui;
          " placeholder="例）
支店
営業所
工場"></textarea>
        </div>
      </div>

      <!-- 設定 -->
      <div class="card" style="background:var(--card-soft);">
        <div>
          <label style="font-weight:700; display:block; margin-bottom:6px;">
            間に入れる文字（任意）
          </label>
          <input id="between4" type="text" style="
            width:100%; padding:10px;
            border-radius:14px; border:1px solid var(--border);
            font-size:1rem;
          " placeholder="例）_  /  -  ,  など。空欄OK">
        </div>

        <div style="display:flex; gap:12px; flex-wrap:wrap; margin-top:10px;">
          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="trimSpaces4" checked>
            前後の空白を消す
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="removeEmpty4" checked>
            空行を無視（左右それぞれ）
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="broadcast4" checked>
            片側が1行だけなら全行に同じ文字を付ける
          </label>
        </div>

        <p class="mini" style="margin-top:8px;">
          ※行数が違う場合、足りない側は空欄として結合します。
        </p>
      </div>

      <!-- ボタン -->
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button onclick="runTwoColJoin4(); gtag('event', 'tool_run', { tool: 'TwoColJoin' });" class="btn btn-primary" style="min-width:220px;">
          結合する🪄
        </button>
        <button onclick="clearTwoColJoin4()" class="btn btn-ghost">
          クリア
        </button>
      </div>

      <!-- 出力 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">出力：</label>
        <textarea id="outputText4" rows="7" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:ui-monospace;
        " readonly></textarea>

      <button id="copy4"
        onclick="copyText('outputText4','copy4')"
        class="btn copy-btn" style="margin-top:10px;">
        コピーする
      </button>

      </div>

      <div class="example" style="font-size:0.9rem;">
        例：<br>
        左：A / B / C<br>
        右：_X（1行だけ）<br>
        出力：A_X / B_X / C_X
      </div>

    </div>
  </div>
</section>

<script>
  function normalizeLines4(raw, trimSpaces, removeEmpty){
    let lines = raw.split(/\r?\n/);
    if(trimSpaces) lines = lines.map(x => x.trim());

    // ★末尾の空行（空白含む）を削除する
    while (lines.length > 0 && lines[lines.length - 1].trim() === "") {
      lines.pop();
    }
    
    if(removeEmpty) lines = lines.filter(x => x !== "");
    return lines;
  }

  function runTwoColJoin4(){
    const leftRaw  = document.getElementById("leftText4").value;
    const rightRaw = document.getElementById("rightText4").value;

    if(!leftRaw.trim() && !rightRaw.trim()){
      alert("左か右、どちらかに入力してください");
      return;
    }

    const between    = document.getElementById("between4").value ?? "";
    const trimSpaces = document.getElementById("trimSpaces4").checked;
    const removeEmpty= document.getElementById("removeEmpty4").checked;
    const broadcast  = document.getElementById("broadcast4").checked;

    const left  = normalizeLines4(leftRaw, trimSpaces, removeEmpty);
    const right = normalizeLines4(rightRaw, trimSpaces, removeEmpty);

    // 片側0行のときは、もう片側だけを出す（betweenは無視）
    if(left.length === 0){
      document.getElementById("outputText4").value = right.join("\n");
      return;
    }
    if(right.length === 0){
      document.getElementById("outputText4").value = left.join("\n");
      return;
    }

    // ---- 片側1行を全行に適用（ブロードキャスト）----
    if(broadcast){
      if(left.length === 1 && right.length >= 1){
        const l0 = left[0];
        document.getElementById("outputText4").value =
          right.map(r => l0 + between + r).join("\n");
        return;
      }
      if(right.length === 1 && left.length >= 1){
        const r0 = right[0];
        document.getElementById("outputText4").value =
          left.map(l => l + between + r0).join("\n");
        return;
      }
    }

    // ---- 通常結合：行数が違うなら空欄で補完（最大行数に合わせる）----
    const maxLen = Math.max(left.length, right.length);
    const out = [];
    for(let i=0; i<maxLen; i++){
      const l = left[i] ?? "";
      const r = right[i] ?? "";
      out.push(l + between + r);
    }

    document.getElementById("outputText4").value = out.join("\n");
  }

  function clearTwoColJoin4(){
    document.getElementById("leftText4").value = "";
    document.getElementById("rightText4").value = "";
    document.getElementById("between4").value = "";
    document.getElementById("outputText4").value = "";
    document.getElementById("trimSpaces4").checked = true;
    document.getElementById("removeEmpty4").checked = true;
    document.getElementById("broadcast4").checked = true;
  }
</script>
 
<!-- === FREE TOOL ⑤ : 特定文字を含む行の削除 / 抽出 === -->
<section id="tool-remove-contains" style="margin-top:32px;">
  <h2 style="font-size:1.4rem; margin-bottom:10px;">特定の文字を含む行を削除 / 抽出</h2>
  <p class="subtitle" style="margin-bottom:14px;">
    指定した文字が入っている行を「消す」か「残す」かを選べます。  
    いらない行の削除にも、必要な行の抽出にも使えます。
  </p>

  <div style="
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 22px;
    padding: 18px;
    box-shadow: var(--shadow-soft);
  ">
    <div style="display:flex; flex-direction:column; gap:14px;">

      <!-- 入力欄 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">
          入力（複数行OK）：
        </label>
        <textarea id="inputText5" rows="7" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:system-ui;
        " placeholder="ここに文字を貼り付けてください"></textarea>
      </div>

      <!-- 条件 -->
      <div class="card" style="background:var(--card-soft);">
        <label style="font-weight:700; display:block; margin-bottom:6px;">
          対象にしたい文字（1つでも複数でもOK）
        </label>
        <textarea id="keywords5" rows="3" style="
          width:100%; padding:10px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:system-ui;
        " placeholder="例）
NG
不要
test"></textarea>
        <div class="mini">
          ※改行またはカンマ区切りで複数指定できます
        </div>

        <div style="display:flex; gap:12px; flex-wrap:wrap; margin-top:10px;">
          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="trimSpaces5" checked>
            前後の空白を消す
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="removeEmpty5" checked>
            空行を無視
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="caseInsensitive5" checked>
            大文字/小文字を区別しない
          </label>
        </div>
      </div>

      <!-- ボタン（2種類） -->
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button onclick="runFilter5('remove'); gtag('event', 'tool_run', { tool: 'Remove_Filter' });" class="btn btn-primary" style="min-width:220px;">
          含む行を削除する🪄
        </button>

        <button onclick="runFilter5('keep'); gtag('event', 'tool_run', { tool: 'Keep_Filter' });" class="btn" style="min-width:220px;">
          含む行だけ残す（抽出）🪄
        </button>

        <button onclick="clearTool5()" class="btn btn-ghost">
          クリア
        </button>
      </div>

      <!-- 出力 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">出力：</label>
        <textarea id="outputText5" rows="7" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:ui-monospace;
        " readonly></textarea>
      
      <button id="copy5"
        onclick="copyText('outputText5','copy5')"
        class="btn copy-btn" style="margin-top:10px;">
        コピーする
      </button>

      </div>

      <div class="example" style="font-size:0.9rem;">
        例：<br>
        対象文字：NG<br>
        入力：OK / NGあり / OK<br>
        削除 → OK / OK<br>
        抽出 → NGあり
      </div>

    </div>
  </div>
</section>

<script>
  function parseKeywords5(raw){
    return raw
      .split(/[\n,]/)
      .map(x => x.trim())
      .filter(x => x !== "");
  }

  function runFilter5(mode){
    const rawText = document.getElementById("inputText5").value;
    const rawKeys = document.getElementById("keywords5").value;

    if(!rawText.trim()){
      alert("入力欄が空です");
      return;
    }
    if(!rawKeys.trim()){
      alert("対象にしたい文字を入力してください");
      return;
    }

    const trimSpaces = document.getElementById("trimSpaces5").checked;
    const removeEmpty = document.getElementById("removeEmpty5").checked;
    const caseInsensitive = document.getElementById("caseInsensitive5").checked;

    let lines = rawText.split(/\r?\n/);
    if(trimSpaces) lines = lines.map(x => x.trim());

    // ★ 末尾の空行（空白含む）を削除
    while (lines.length > 0 && lines[lines.length - 1].trim() === "") {
      lines.pop();
    }
    
    if(removeEmpty) lines = lines.filter(x => x !== "");

    const keywords = parseKeywords5(rawKeys);
    const keysLower = caseInsensitive ? keywords.map(k => k.toLowerCase()) : keywords;

    const result = lines.filter(line => {
      const target = caseInsensitive ? line.toLowerCase() : line;
      const hit = keysLower.some(k => k !== "" && target.includes(k));
      // remove: ヒットしたら削除（false）
      // keep: ヒットしたら残す（true）
      return mode === "remove" ? !hit : hit;
    });

    document.getElementById("outputText5").value = result.join("\n");
  }


  function clearTool5(){
    document.getElementById("inputText5").value = "";
    document.getElementById("keywords5").value = "";
    document.getElementById("outputText5").value = "";
    document.getElementById("trimSpaces5").checked = true;
    document.getElementById("removeEmpty5").checked = true;
    document.getElementById("caseInsensitive5").checked = true;
  }
  
</script>

  <!-- === FREE TOOL ⑥ : 行の並び替え（ソート） === -->
<section id="tool-sort-lines" style="margin-top:32px;">
  <h2 style="font-size:1.4rem; margin-bottom:10px;">行の並び替え（ソート）</h2>
  <p class="subtitle" style="margin-bottom:14px;">
    改行で並んだ文字を、昇順・降順で並び替えます。  
    文字列としての並び替えと、数値としての並び替えが選べます。
  </p>

  <div style="
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 22px;
    padding: 18px;
    box-shadow: var(--shadow-soft);
  ">
    <div style="display:flex; flex-direction:column; gap:14px;">

      <!-- 入力欄 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">入力（複数行OK）：</label>
        <textarea id="inputText6" rows="7" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:system-ui;
        " placeholder="例）
3
10
2
1"></textarea>
      </div>

      <!-- オプション -->
      <div class="card" style="background:var(--card-soft);">
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; align-items:center;">
          <div>
            <label style="font-weight:700; display:block; margin-bottom:6px;">並び順：</label>
            <select id="order6" style="
              width:100%; padding:10px;
              border-radius:14px; border:1px solid var(--border);
              background:white; font-size:1rem;
            ">
              <option value="asc" selected>昇順（A→Z / 小→大）</option>
              <option value="desc">降順（Z→A / 大→小）</option>
            </select>
          </div>

          <div>
            <label style="font-weight:700; display:block; margin-bottom:6px;">ソート方法：</label>
            <select id="mode6" style="
              width:100%; padding:10px;
              border-radius:14px; border:1px solid var(--border);
              background:white; font-size:1rem;
            ">
              <option value="text" selected>文字列として並び替え</option>
              <option value="number">数値として並び替え</option>
            </select>
          </div>
        </div>

        <div style="display:flex; gap:12px; flex-wrap:wrap; margin-top:10px;">
          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="trimSpaces6" checked>
            前後の空白を消す
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="removeEmpty6" checked>
            空行を無視
          </label>

          <label style="display:flex; align-items:center; gap:6px;">
            <input type="checkbox" id="caseInsensitive6" checked>
            大文字/小文字を区別しない（文字列ソート用）
          </label>
        </div>
      </div>

      <!-- ボタン -->
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button onclick="runSort6(); gtag('event', 'tool_run', { tool: 'Sort' });" class="btn btn-primary" style="min-width:220px;">
          並び替える🪄
        </button>
        <button onclick="clearTool6()" class="btn btn-ghost">
          クリア
        </button>
      </div>

      <!-- 出力 -->
      <div>
        <label style="font-weight:700; display:block; margin-bottom:6px;">出力：</label>
        <textarea id="outputText6" rows="7" style="
          width:100%; padding:12px; border-radius:14px;
          border:1px solid var(--border); font-size:1rem;
          font-family:ui-monospace;
        " readonly></textarea>

        <button id="copy6"
        onclick="copyText('outputText6','copy6')"
        class="btn copy-btn" style="margin-top:10px;">
        コピーする
      </button>

      </div>

      <div class="example" style="font-size:0.9rem;">
        例：<br>
        入力：3 / 10 / 2 / 1<br>
        数値ソート・昇順 → 1 / 2 / 3 / 10
      </div>

    </div>
  </div>
</section>

<script>
  function runSort6(){
    const raw = document.getElementById("inputText6").value;
    if(!raw.trim()){
      alert("入力欄が空です");
      return;
    }

    const order = document.getElementById("order6").value; // asc / desc
    const mode = document.getElementById("mode6").value;   // text / number
    const trimSpaces = document.getElementById("trimSpaces6").checked;
    const removeEmpty = document.getElementById("removeEmpty6").checked;
    const caseInsensitive = document.getElementById("caseInsensitive6").checked;

    let lines = raw.split(/\r?\n/);
    if(trimSpaces) lines = lines.map(x => x.trim());

    // ★ 末尾が空行（空文字 or 空白だけ）の場合は処理対象から外す
    while (lines.length > 0 && lines[lines.length - 1].trim() === "") {
      lines.pop();
    }
    
    if(removeEmpty) lines = lines.filter(x => x !== "");

    let sorted;

    if(mode === "number"){
      // 数値としてソート（数値化できない行は最後に回す）
      sorted = [...lines].sort((a, b) => {
        const na = parseFloat(a);
        const nb = parseFloat(b);
        const aIsNum = !Number.isNaN(na);
        const bIsNum = !Number.isNaN(nb);

        if(aIsNum && bIsNum) return na - nb;
        if(aIsNum && !bIsNum) return -1;
        if(!aIsNum && bIsNum) return 1;
        return a.localeCompare(b, "ja");
      });
    } else {
      // 文字列としてソート
      sorted = [...lines].sort((a, b) => {
        const aa = caseInsensitive ? a.toLowerCase() : a;
        const bb = caseInsensitive ? b.toLowerCase() : b;
        return aa.localeCompare(bb, "ja");
      });
    }

    if(order === "desc"){
      sorted.reverse();
    }

    document.getElementById("outputText6").value = sorted.join("\n");
  }

  function clearTool6(){
    document.getElementById("inputText6").value = "";
    document.getElementById("outputText6").value = "";
    document.getElementById("order6").value = "asc";
    document.getElementById("mode6").value = "text";
    document.getElementById("trimSpaces6").checked = true;
    document.getElementById("removeEmpty6").checked = true;
    document.getElementById("caseInsensitive6").checked = true;
  }
</script>


  
  <!-- USE CASES -->
  <section id="usecases">
    <h2 style="font-size:1.5rem;margin-bottom:6px;">こんな時に役立ちます</h2>

    <div class="two-col">
      <div class="card">
        <h3>リストや項目をまとめて整えたいとき</h3>
        <ul class="subtitle">
          <li>たくさんの値を同じ形にそろえたい</li>
          <li>記号やカンマをまとめて付けてコピーしたい</li>
          <li>貼り付ける前に、見やすく整えたい</li>
        </ul>
      </div>

      <div class="card">
        <h3>Excelの文字整形に</h3>
        <ul class="subtitle">
          <li>毎回の結合作業を関数なしで済ませたい</li>
          <li>決まった形式の文字列を一括で作りたい</li>
          <li>手作業のコピペ加工を減らしたい</li>
        </ul>
      </div>
    </div>
  </section>

  <section class="card" style="margin-bottom:20px;">
    <h2 style="margin:0 0 6px;">ユーザーの声をお聞かせください</h2>
    <p class="subtitle">
      「こんな機能がほしい」「ここが使いにくい」といった
      ユーザーの要望を参考にしながら、少しずつ改善を続けています。
    </p>
    <p class="subtitle">
      無料ツール・有料版に関わらず、要望はどなたでも送ることができます。
    </p>
    <a href="/request.html" class="btn btn-ghost" style="margin-top:6px;">
      💬 要望を送る
    </a>
  </section>

  
  <!-- PRO -->
  <section id="pro">
    <h2 style="font-size:1.5rem;margin-bottom:6px;">有料版（Mojician Pro）</h2>
    <p class="subtitle">
      まずは無料で気軽に使ってもらい、  
      もっと便利に使いたくなった方のために Pro版もあります。
    </p>

    <div style="
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 20px;
    ">
      <a href="/pro.html"
         class="btn btn-primary"
         onclick="gtag('event', 'pro_click');
         style="font-size:1rem;">
        🚀 Pro版の機能を見てみる
      </a>
    
      <a href="https://pro.mojician.jp/auth/signin"
         class="btn btn-pro-login"
         style="font-size:1rem;">
        🔑 Proログイン
      </a>
    </div>
    
    <p class="mini" style="margin-top:8px; text-align:center;">
      条件保存・差分比較・辞書置換などの便利機能が使えます
    </p>

    
  </section>

  <!-- FAQ -->
  <section id="faq" class="faq">
    <h2 style="font-size:1.5rem;margin-bottom:6px;">よくある質問</h2>

    <details>
      <summary>入力した文字はどこかに保存されますか？</summary>
      <div class="subtitle">
        いいえ。Mojicianは入力データを保存しません。  
        ブラウザの中だけで加工して表示します。
      </div>
    </details>

    <details>
      <summary>Mojicianはどんな人に向いていますか？</summary>
        <div class="subtitle">
          Mojicianは、文字列をまとめて加工・整理したい方に向けたツールです。
          特に、Excel関数やプログラミングが苦手な方でも、
          コピペとボタン操作だけで文字を整えたい場合に役立ちます。
          <br><br>
          事務作業やデータ整理を行う方、リスト作成やチェック作業が多い方、
          SQLやシステムに貼り付ける前の文字整形を行う方などにおすすめです。
        </div>
    </details>
    
    <details>
      <summary>パソコンが苦手でも使えますか？</summary>
      <div class="subtitle">
        もちろんです。  
        貼り付けて、ボタンを押すだけで動くように作っています。
      </div>
    </details>

    <details>
      <summary>無料でどこまで使えますか？</summary>
      <div class="subtitle">
        日常でよく使う文字加工を無料で提供します。  
        便利な機能は順番に増やしていきます。
      </div>
    </details>

    <details>
      <summary>有料版は何が違いますか？</summary>
      <div class="subtitle">
        ①条件保存ができます。
        ②テキスト差分比較、特定位置への文字を挿入、複数キーワードの一括置換（辞書置換）の機能が使用可能です。
      </div>
    </details>
  </section>

</main>

<footer>
  <div class="wrap">
    <div class="footer-links">
      <a href="/privacy.html">プライバシーポリシー</a>
      <a href="/terms.html">利用規約</a>
      <a href="/contact.html">お問い合わせ</a>
    </div>
    <div style="margin-top:8px;">© Mojician</div>
  </div>
</footer>
<script>
// 出力欄IDとボタンIDを受け取ってコピーする共通関数
  function copyText(textareaId, buttonId){
    const out = document.getElementById(textareaId);
    if(!out) return;

    out.select();
    document.execCommand("copy");

    setCopied(buttonId);
  }
function setCopied(buttonId) {
  const btn = document.getElementById(buttonId);
  if(!btn) return;

  // 既存タイマーがある場合はリセット
  if(btn._timer){
    clearTimeout(btn._timer);
  }

  // ボタンをコピー完了状態に
  btn.classList.add("copied");
  btn.textContent = "✓ コピーしました";

  // 2秒後に元に戻す
  btn._timer = setTimeout(() => {
    resetCopyStatus(btn);
  }, 2000);
}

// ボタンを元に戻す
function resetCopyStatus(btn){
  btn.classList.remove("copied");
  btn.textContent = "コピーする";
  btn._timer = null;
}
  </script>
    <style>
/* コピー完了時の見た目 */
.copied {
  background: #dff3e8 !important;
  color: #247a46 !important;
  border-color: #b8e6c9 !important;
}
</style>
</body>
</html>
